# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Pre-commit hooks â€” runs automatically before every `git commit`
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Blocks commit if any check fails. Ensures lint, format, and tests
# pass BEFORE code reaches GitHub â€” catches issues the CI would reject.
#
# Install:  pre-commit install
# Manual:   pre-commit run --all-files
# Update:   pre-commit autoupdate
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

repos:
  # â”€â”€ Ruff: lint + format (replaces flake8, isort, black) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.9.6
    hooks:
      - id: ruff
        name: "ğŸ” ruff lint"
        args: [--fix]
      - id: ruff-format
        name: "ğŸ“ ruff format"

  # â”€â”€ Tests: full suite (math + unit + codereview) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  - repo: local
    hooks:
      - id: pytest
        name: "ğŸ§ª pytest (344 tests)"
        entry: python3 -m pytest tests/ -q --tb=short -k "not network"
        language: system
        pass_filenames: false
        always_run: true
        stages: [pre-commit]

      - id: security-gate
        name: "ğŸ”’ Security Gate (T31-T40)"
        entry: python3 -m pytest tests/test_codereview.py -q --tb=short -k "t31 or t32 or t33 or t34 or t35 or t36 or t37 or t38 or t39 or t40"
        language: system
        pass_filenames: false
        always_run: true
        stages: [pre-commit]
